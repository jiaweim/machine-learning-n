# 泊松分布

2020-08-30, 22:20
***

## 泊松试验

泊松试验（Poisson experiment）是满足如下条件的试验：

- 试验成功的次数是可计算的
- 在特定时间间隔（或空间间隔）内发生的平均次数是已知的
- 每个结果相互独立
- 试验成功的可能性与区间大小成正比

泊松试验常见于指定单位时间、单位距离、单位面积或单位体积内发生的事件个数。例如：

- 某个城市一天内车祸数
- 一平方米内蒲公英数

泊松分布的一个典型例子是一天中每小时出生的婴儿数。例如，假设某医院每小时平均分娩 10 次，其满足泊松分布条件：

- 试验成功的次数可计算，出生了多少婴儿
- 特定时间间隔内发生的平均次数是已知的，即每小时平均有10个婴儿出生
- 每个结果相互独立，一个母亲在给定时间内生育的概率与另一个母亲无关
- 成功的概率与时间间隔成正比，即时间越长，发生分娩的概率越高

## 泊松分布推导

二项分布是最有名的离散概率模型，其次是 Poisson 分布，它可以看作二项分布的一种极限情形。

假设某公司的总机在一个短时间 $\Delta t$ 内接到一次电话的概率与 $\triangle t$ 成正比：

$$
p=\alpha \Delta t
$$

$\alpha$ 是一个常数。又假定在此短时间内接到多于一个电话的概率极小，可以忽略不计。那么在时间 t 内，接到 x 次电话的概率分布如何？

我们可以把 t 分成 n 个小段，每小段长度为 $\Delta t=t/n$。上述问题就变为：在每个 $\Delta t$事件内，我们做一次试验，其成功的概率为 p。如此做了 n 次，那么成功了 x 次的概率为何？所以我们要的概率分布为二项分布 $b(x;n,p)$。现在令 $\lambda=\alpha t=n\alpha \Delta t=np$，则有：

$$
\begin{aligned}
b(x;n,p)
&=\frac{n!}{x!(n-x)!}p^x(1-p)^{n-x}\\
&=\frac{n(n-1)(n-2)...(n-x-1)}{x!}(\frac{\lambda}{n})^x(1-\frac{\lambda}{n})^{n-x}\\
&=(1-\frac{1}{n})(1-\frac{2}{n})...(1-\frac{x-1}{n})\frac{1}{x!}\lambda ^x((1-\frac{\lambda}{n})^{-\frac{n}{\lambda}})^{-\lambda}(1-\frac{\lambda}{n})^{-x}
\end{aligned}
$$

当 t 保持不变，由于 $\alpha$ 是常数，所以 $\lambda$ 不变，让 $n\rightarrow \infty$，则有：

$$
\begin{aligned}
(1-\frac{1}{n})(1-\frac{2}{n})...(1-\frac{x-1}{n})\rightarrow 1
\end{aligned}
$$

$$
(1-\frac{\lambda}{n})^{-\frac{n}{\lambda}} \rightarrow e
$$

$$
(1-\frac{\lambda}{n})^{-x}\rightarrow 1
$$
所以：
$$
b(x;n,p)\rightarrow \frac{\lambda ^xe^{-\lambda}}{x!}
$$
以 $p(x;\lambda)$ 表示，这里 p 表示 Poisson，即**泊松分布**为：
$$
p(x;\lambda)=\frac{\lambda ^xe^{-\lambda}}{x!}
$$
表述为 x 为服从参数为 $\lambda$ 的泊松分布。因为：

$\displaystyle\sum_{x=0}^{\infty}p(x;\lambda)=e^{-\lambda}\sum_{x=0}^{\infty}\frac{\lambda ^x}{x!}=e^{-\lambda}e^{\lambda}=1$

所以 $p(x;\lambda)$ 是一个概率分布（各种概率加和为1）。

所以，在时间 t 内，接到 x 次电话的概率为 $p(x;\lambda)$。这是以 $\lambda$ 为参数的 Poisson 分布，而 $\lambda=\alpha t$ 是在时间 t 内所期望接到的电话数。

## 历史

Simeon D. Poisson (1781~1840) 是一个著名的法国数学家及物理学家。到了晚年，他热衷于将数学的概率论用到司法的运作上。他在这方面的主要著作是 1837 年出版的《司法概率的研究》（Recherches sur la Probabilite des Jugements）。虽然这本书的主旨是要对司法运作有具体的贡献，但它包含了许多纯粹数学的、概率的理论，所以可以看作一本以司法应用为例的概率课本。在这本书的数学推导中，Poisson 从二项分布的极限得到了这个日后以他为名的概率分布。

Poisson 虽然得到这样的概率分布，但在书中他并没有继续讨论这种分布的性质，在往后的研究中，Poisson 似乎也把它忘掉了。

在十九世纪的许多统计研究报告上，Poisson 这个名字经常出现，但这与 Poisson 分布无关，大家所关注的是他在常态分布方面的研究。常态分布在解释理论与数据变异之间的关系非常成功，当时许多人认为常态分布是概率与统计之间唯一的桥梁。

到 19 世纪末，Bortkiewicz 注意到 Poisson 分布与某些数据之间有关联。Ladislaus von Bortkiewicz（1868～1931年）是出生在俄国圣彼得堡的波兰人。他在德国 Göttingen 大学得到学位（1893年），并曾在 Strassburg 做过研究。在 Strassburg 时，他写了一本小册子《小数法则》(Das Gesetz der Kleinen Zahlen)，专门研究 Poisson 分布。他不但在理论方面推演了 Poisson 分布的许多性质，并且在应用方面，也比较了一些实际发生的、有关于自杀或意外伤害的数据。 Poisson 分布虽然出于 Poisson 之手，但真正使它为人重视，使它成为统计学一部分的可要算是 Bortkiewicz了。

在这本书中，Bortkiewicz 举了一个至今仍是脍炙人口的例子，说明数据契合 Poisson 分布的情形。从1875到1894年的20年间，德国的十四个军团部有士兵被马踢伤因而致死的人数纪录。这 20×l4 = 280个（团年）纪录，按死亡人数来分，则如表一的左二栏所示。

|x=每年死亡人數|团年数|280p(x;0.7)|
|---|---|---|
|0|144|139.0|
|1|91|97.3|
|2|32|34.1|
|3|11|8.0|
|4|2|1.4|
|$\geq5$|0|0.2|

在 280 个记录中，死亡人数共有 196，因此致死率为 $\alpha=196/280=0.7$。我们将该 $\alpha$ 作为 Poisson 分布中的常数，t=1 年，则 $\lambda=\alpha t=0.7$。理想中每团每年死亡人数 x 要服从 Poisson 分布 $p(x;0.7)$。上表中右侧就是根据这样的 Poisson 分布，把 280 图年有 x 人死亡的图年数列出。它和表中中间一栏的数据十分吻合。

Poisson 分布既然是二项分布的极限情形，反过来Poisson分布也可以作为二项分布的近似值。例如 p=0.04,n=49，则 $\lambda=49\times0.04=1.96$。我们把 $b(x;49,0.04)$和 $p(x;1.96)$ 进行对比：

|x|b(x;49,0.04)|p(x;1.96)|
|---|---|---|
|0|0.135|0.141|
|1|0.276|0.276|
|2|0.276|0.270|
|3|0.180|0.176|
|4|0.086|0.086|
|5|0.032|0.034|
|6|0.010|0.011|
|7|0.003|0.003|
|8|0.001|0.001|
|$\vdots$|$\vdots$|$\vdots$|

我们发现对应的值相当接近。一般，若用列表形式，二项分布 $b(x;n,p)$ 要兼顾三个变量 x,n,p，而 Poisson 只要两个 x,λ，所以比较方便。若直接计算，则因为：
$$
b(x;49,0.04)=\binom{49}{x}0.04^x0.96^{49-x}
$$
二项分布计算起来很费事。而 $p(x;\lambda)$ 的值可用递归快速计算：
$$
\frac{p(x+1;\lambda)}{p(x;\lambda)}=\frac{\lambda}{x}+1
$$
而 $p(0;\lambda)=e^{-1}$。因此只要情况适合，我们当然就舍二项分布而使用 Poisson 分布。

通常只有 n 很大,p很小，$\lambda=np$不大不小而且是个常数，就可以用 Poisson 分布代替二项分布。

譬如某商店每星期进出的人数很多（n），但客人买鱼子酱的概率很小（p），只知道平均一星期卖出两罐：$\lambda=np=2$。那么这家商店每星期开始时应有几罐鱼子酱的库存？当然不能只有两罐，因为平均归平均，销售量超过平均的概率很大，当然库存太多也会影响整个商店的运作。根据 Poisson 分布 $p(x;2)$，我们算得下表：

|λ|0|1|2|3|4|5|$\geq6$|
|---|---|---|---|---|---|---|---|
|p(x;2)|.135|.271|.271|.180|.090|.036|.017|

由上表可知销售量达到 5 罐以上的概率只有 5.3%，而达到 6 罐以上则只有 1.7%。所以合理的库存量为 4 罐（平均 19 星期才会有一次缺货），如果怕万一，那么 5 罐就非常保险（平均 59 星期才回有一次缺货）。

我们从另一个角度来看上面的数据。假设某工厂每做100个螺丝钉，平均会有两个不合规格，而这是合理的不合格率。根据 Poisson 分布，偶而出现 3 个或 4 个不合规格的螺丝钉也是正常的现象。但是如果出现的频率太高，或出现 5 个以上的不合规格的螺丝钉，那么生产过程就可能出了问题。 Poisson 分布是品质管制的利器，它可以帮助我们决定生产过程是否出了毛病。

Poisson 分布还有种种的用途：放射性物质的蜕变、细胞间因受 X 光照射而引起的染色体交换次数、细菌和血球的计数、交通事故数及死亡率等等莫不遵行 Poisson 分布。其实，无论在自然科学、在工业、在农业、在商业、在医药、在交通、在社会或在军事上，无不可找到 Poisson 分布的应用。

## 泊松分布应用情形

泊松试验常见于指定单位时间、单位距离、单位面积或单位体积内发生的事件个数这种场合。例如：

- 一本书一页中的印刷错误数；
- 某地区一天丢失的邮件数；
- 某医院一天内的急诊病人数；
- 某地区一个时间间隔内发生交通事故的次数。

当 n 足够大，p 很小，$\lambda=np$ 不大不小且是个常数时，就可以用 Poisson 分布。

## 泊松分布属性

由 $p(x;\lambda)=\lambda ^xe^{-\lambda}/x!$ 有：
$$
\begin{aligned}
\mu=\sum_{x=0}^{\infty}xp(x;\lambda)=\lambda e^\lambda\sum_{x=1}^{\infty}\frac{\lambda^{x-1}}{(x-1)!}=\lambda e^{-\lambda}e^\lambda=\lambda
\end{aligned}
$$

$$
\begin{aligned}
\sigma^2
&=\sum_{x=0}^{\infty}(x-\lambda)^2p(x;\lambda)\\
&=\sum_{x=0}^{\infty}(x(x-1)-(2\lambda-1)x+\lambda ^2)p(x;\lambda)\\
&=\sum_{x=0}^{\infty}x(x-1)p(x;\lambda)-(2\lambda-1)\sum_{x=0}^{\infty}xp(x;\lambda)+\lambda ^2\sum_{x=0}^{\infty}p(x;\lambda)
\end{aligned}
$$

所以，泊松分布**均值**：

$$\mu=\lambda$$

**方差**：

$$\sigma^2=\lambda$$

**标准差**：

$$\sigma=\sqrt{\lambda}$$

## R 实现

`dpois` 计算概率密度，`ppois` 计算累积分布函数，`qpois` 给出分位数，`rpois` 生成随机数。

### 概率密度

`dpois` 计算概率密度。

```r
dpois(x, lambda, log = FALSE)
```

`x` 为成功次数，`lambda` 为成功次数均值，即 λ。

例1：

假设某店平均每小时卖出10个产品，则在某个小时，该店卖出 8 个产品的概率？

```r
> dpois(x = 8, lambda = 10)
[1] 0.112599
```

### 累积概率密度

```r
ppois(q, lambda, lower.tail = TRUE, log.p = FALSE)
```

`q` 为成功次数，`lambda` 为平均成功次数，即 $\lambda$。

**例1：** 假设某店平均每小时卖出10个产品，则在某个小时，该店卖出产品个数不超过 8 个的概率？

```r
> ppois(q = 8, lambda = 10)
[1] 0.3328197
```

**例2：** 现在需要 100 个符合规格的元件，从市场上买的该元件有 0.01 的废品率。所以如果只买100个，它们全部符合规则的机会不大，因此，我们要买 100+a 个，要求“在 100+a 个元件中至少有 100 个符合规格”这件事的概率不小于0.95.问 a 多大？

这就是个累积概率问题，要求 100+a 中有 $\geq a$ 个废品的概率小于 0.05。

由于 100+a 这个数较大，而 0.01 很小，所以可以用泊松分布来算。

$\lambda=(100+a)\times0.01=1+0.01a$，由于 a 应该不大，所以取 $\lambda=1$。

```r
> print(ppois(q = 0, lambda = 1))
[1] 0.3678794
> print(ppois(q = 1, lambda = 1))
[1] 0.7357589
> print(ppois(q = 2, lambda = 1))
[1] 0.9196986
> print(ppois(q = 3, lambda = 1))
[1] 0.9810118
```

所以 $x\leq 3$ 的概率达到 98$，所以 a 取 3 即可。

### 分位数

```r
qpois(p, lambda, lower.tail = TRUE, log.p = FALSE)
```

分位数，即累积概率的逆计算，计算在指定累积概率 `p` 下的最小 x 值。

### 随机数

```r
rpois(n, lambda)
```

随机数生成器，`n` 为生成随机数的个数，`lambda` 是平均成功次数。

## hipparchus 实现

`org.hipparchus.distribution.discrete.PoissonDistribution`

