# 概率论


2020-07-04
@author Jiawei Mao
***

## 随机事件

生活中充满了随机性。概率论是一门用数学语言来刻画这些随机事件的学科。一个随机事件的概率是一个介于0与1之间的实数，这个实数的大小反映了这个事件发生的可能性。概率为 0 意味着这个事件不可能发生（不可能事件），概率为1意味着这个事件必然发生（必然事件）。

**试验**：观察、测量和实验。

**随机试验**具有如下特征：

1. 可以在相同条件下重复进行
2. 每次试验的可能结果不止一个，并且能事先明确试验的所有可能结果
3. 进行一次试验之前不确定哪一个结果会出现

在概率论中，将具有上述三个特点的试验称为**随机试验**。

**事件**：随机试验的每种结果

- **基本事件**：相对实验目的来说，不能再分。
- **复合事件**：由基本事件组合而成。

下面举随机试验的例子：

- $E_1$, 抛一枚硬币，观察证明 H、反面出现的情况
- $E_2$, 将硬币抛掷三次，观察正反面出现的情况

## 样本空间与随机事件

对于随机试验，尽管在每次试验之前不能预知试验的结果，但试验的所有可能结果组成的集合是已知的。随机试验 $E$ 的所有可能结果组成的集合称为 $E$ 的**样本空间**，记为 $S$。样本空间的元素，即 $E$ 的每个结果，称为**样本点**。

试验 $E$ 的样本空间 $S$ 的子集为 $E$ 的**随机事件**，简称**事件**。由一个样本点组成的单点集合，称为**基本事件**。

样本空间 $S$ 包含所有的样本点，它是 $S$ 自身的子集，每次试验它总是发生，$S$ 称为**必然事件**。空集 $\phi$ 不包含任何样本点，也作为样本空间的子集，它在每次试验中都不发生，称为**不可能事件**。

### 事件运算

事件是一个**集合**，因此事件间的关系与事件的运算按照集合论中的集合运算来处理。

设试验 $E$ 的样本空间为 $S$，而 $A$, $B$, $A_k$ ($k=1,2,...$)是 $S$ 的子集。

1. 若 $A\subset B$，则称事件 $B$ 包含事件 $A$，事件 $A$ 发生必导致事件 $B$ 发生
   - 若 $A\subset B$ 且 $B\subset A$，即 $A=B$，则称事件 A 与事件 B **相等**

2. 若事件 $A\cup B=\{x|x\in A\text{ 或 } x\in B\}$ 称为事件 A 与事件 B 的**和事件**。当且仅当A,B 中至少有一个发生时，事件 $A\cup B$ 发生。
3. 

## 期望

一个随机变量的期望是这个随机变量的概率分布的“中心”。简而言之，当有无穷多来自同一个概率分布的独立样本时，它们的平均值就是期望。数学上对期望的定义是以概率（或密度）为权重的加权平均值。

$$E[X]=\sum_{x\in X}xP(x)$$

## 方差

如果说随机变量的期望刻画了它的概率分布的“中心”，那么方差则刻画了概率分布的分散度。方差的定义是一个随机变量与它的期望之间的差的平方的加权平均值。这里的权重仍然是概率（或者密度）。

$$Var(X)=E[(X-E[X])^2]$$

## 等可能概率（古典概率模型）

具有以下两个特点的试验：

1. 试验的样本空间只包含有限个元素
2. 试验中每个基本事件发生的可能性相同

具有中两个特点的试验大量存在，这种试验称为**等可能概型**，也称为**古典概率模型**。等可能概型的概念直观、容易理解，有着广泛的应用。

下面讨论等概率模型中事件概率的计算方法。

设试验的样本空间为 $S=\{e_1,e_2,...,e_n\}$，试验中每个基本事件发生的概率相同，即：

$$
P(e_1)=P(e_2)=\cdots P(e_n)
$$

由于基本事件是两两不不相容的，因此：

$$
\begin{aligned}
P(S)&=P(e_1)+P(e_2)+\cdots+P(e_n)\\
&=P(e_1\cup e_2\cup \cdots \cup e_n)\\
&=1
\end{aligned}
$$

$$
P(e_i)=\frac{1}{n}, \quad i=1,2,...,n
$$

若事件 A 包含 k 个基本事件，则有：

$$
P(A)=\frac{k}{n} \tag{1}
$$

式（1）就是等可能概率模型中事件 A 的概率的计算公式。

**例 1** 将一枚硬币抛掷三次。（1）设事件 A1 为 “恰好有一次出现正面”，求 $P(A_1)$。（2）设事件 A2 为“至少有一次出现正面”，求 $P(A_2)$.

**解** 此时样本空间为：

$$
S=\{HHH,HHT,HTH,THH,HTT,THT,TTH,TTT\}
$$

而:

$$
A_1=\{HTT,THT,TTH\}
$$

样本空间包含有限个元素，根据对称性可知每个基本事件发生的概率相同。因此：

$$
P(A_1)=\frac{3}{8}
$$

由于 $A_2$ 的补集 $\overline{A}_2=\{TTT\}$，因此：

$$
P(A_2)=1-P(\overline{A}_2)=1-\frac{1}{8}=\frac{7}{8}
$$



## 条件概率

条件概率考虑的是事件 A 已经发生的条件下事件 B 发生的概率。例如：

**例 1：**  将一枚硬币抛掷 2 次，观察其出现正反面的情况。设事件 A 为 “至少有一次为 H”，事件 B 为“两次掷出同一面”。现在求已知事件 A 发生的条件下事件 B 发生的概率。

**解：** 样本空间为 $S=\{HH,HT,TH,TT\}$，$A=\{HH,HT,TH\}$, $B=\{HH,TT\}$，显然这是等概率模型。

已知事件 A 已经发生，即知道试验所有可能结果构成的集合就是 A。A 中有 3 个元素，其中只有 $HH\in B$，于是，在事件 A 发生的条件下事件 B 发生的概率为：

$$
P(B|A)=\frac{1}{3}
$$

可以发现，$P(B)=\frac{2}{4}\ne P(B|A)$。

另外，很容易得到：

$$
P(A)=\frac{3}{4},\qquad P(AB)=\frac{1}{4},\quad P(B|A)=\frac{1}{3}
$$

因此：

$$
P(B|A)=\frac{P(AB)}{P(A)} \tag{1}
$$

在等概率模型中很容易正面该公式：设试验的基本事件总数为 $n$，事件 A 包含的基本事件数为 m (m>0)，AB 所包含的基本事件数为 k，得到：

$$
P(B|A)=\frac{k}{n}=\frac{k/n}{m/n}=\frac{P(AB)}{P(A)}
$$

**定义:** 设 A,B 是两个事件，且 $P(A)>0$，则：

$$
P(B|A)=\frac{P(AB)}{P(A)} \tag{2}
$$

称为事件 A 发生的条件下事件 B 发生的**条件概率**。

条件概率 $P(\cdot|A)$ 符合概率定义的三个条件：

1. 非负性：对每一个事件，$P(B|A)\ge 0$
2. 规范性：对必然事件 S，$P(S|A)=1$
3. 可列可见性：设 $B_1,B_2,...$ 是两个互不相容的事件，则有

$$
P(\cup_{i=1}^{\infty} B_i|A)=\sum_{i=1}^{\infty} P(B_i|A)
$$

**例 2** 一盒子装有 4 只产品，包含 3 只一等品，1 只二等品。从中取产品两次，每次任取一只，作不放回抽样。设事件 A 为 “第一次取到一等品”，事件 B 为 “第二次取到一等品”。求条件概率 $P(B|A)$。

**解** 显然这是等概率模型。将产品编号，1,2,3 为一等品，4 为二等品。以 $(i,j)$ 表示第一次、第二次分别取到第 i 号、第 j 号产品。试验 E (取两次)的样本空间为：

$$
S=\{(1,2),(1,3),(1,4),(2,1),(2,3),(2,4),...,(4,1),(4,2),(4,3)\}
$$

$$
A=\{(1,2),(1,3),(1,4),(2,1),(2,3),(2,4),(3,1),(3,2),(3,4)\}
$$

$$
AB=\{(1,2),(1,3),(2,1),(2,3),(3,1),(3,2)\}
$$

根据条件概率公式：

$$
P(B|A)=\frac{P(AB)}{P(A)}=\frac{6}{9}=\frac{2}{3}
$$

也可以直接按条件概率的含义来计算 P(B|A)。当事件 A 发生，试验 E 的所有可能结果的集合就是 A 中的 9 个元素，其中 (1,2),(1,3),(2,1),(2,3),(3,1),(3,2) 属于 B，因此 $P(B|A)=6/9$。

### 乘法定理

由条件概率的定义，很容易得到乘法定理，设 $P(A)>0$，则有：

$$
P(AB)=P(B|A)P(A) \tag{3}
$$

（3）式称为乘法公式。
（3）很容易推广到多个事件的积事件。例如，设A,B,C 为事件，且 $P(AB)>0$，则有：

$$
P(ABC)=P(C|AB)P(AB)=P(C|AB)P(B|A)P(A) \tag{4}
$$

推广到一般形式，设 $A_1,A_2,...,A_n$ 为 n 个事件，$n\ge 2$，且 $P(A_1A_2\cdots A_{n-1})>0$，则有：

$$
P(A_1A_2\cdots A_n)=P(A_n|A_1A_2\cdots A_{n-1})P(A_{n-1}|A_1A_2\cdots A_{n-2})\cdots P(A_2|A_1)P(A_1) \tag{5}
$$

**例 3** 设袋中装有 r 只红球，t 只白球。每次自袋中任取一只球，观察其颜色然后放回，并再放入 a 只与所取的那只球同色的球。若在袋中连续取球四次，试求第一、二次取到红球且第三、四次取到白球的概率。

**解：** 以 $A_i(i=1,2,3,4)$ 表示事件“第 i 次取到红球”，则 $\overline{A}_3$, $\overline{A}_4$ 表示事件第三、四次取到白球。所求概率为：

$$
\begin{aligned}
P(A_1A_2\overline{A}_3\overline{A}_4)&=P(\overline{A}_4|A_1A_2\overline{A}_3)P(\overline{A}_3|A_1A_2)P(A_2|A_1)P(A_1)\\
&=\frac{t+a}{r+t+3a}\cdot \frac{t}{r+t+2a}\cdot\frac{r+a}{r+t+a}\cdot\frac{r}{r+t}
\end{aligned}
$$

**例 4** 设某光学仪器厂制造的透镜，第一次落下时打破的概率为 1/2，若第一次落下未打破，第二次落下打破的概率为 7/10，若前两次落下未打破，第三次落下打破的概率为 9/10。试求透镜落下三次而未打破的概率。

**解：** 以 $A_i(i=1,2,3)$ 表示事件 “透镜第 i 次落下打破”，以 B 表示事件 "透镜落下三次未打破"。因为 $B=\overline{A}_1\overline{A}_2\overline{A}_3$，因此：

$$
\begin{aligned}
P(B)&=P(\overline{A}_1\overline{A}_2\overline{A}_3)\\
&=P(\overline{A}_3|\overline{A}_1\overline{A}_2)P(\overline{A}_2|\overline{A}_1)P(\overline{A}_1)\\
&=(1-\frac{9}{10})(1-\frac{7}{10})(1-\frac{1}{2})\\
&=\frac{3}{200}
\end{aligned}
$$

### 全概率公式和贝叶斯公式

**定义：** 设 $S$ 为试验 E 的样本空间，$B_1,B_2,...,B_n$ 为 E 的一组事件。若：

1. $B_iB_j=\emptyset$, $i\ne j$, $i,j=1,2,...,n$
2. $B_1\cup B_2\cup \cdots \cup B_n=S$

则称 $B_1,B_2,\cdots,B_n$ 为样本空间 $S$ 的一个**划分**。

若 $B_1,B_2,\cdots,B_n$ 是样本空间的一个划分，那么，对每次试验，事件 $B_1,B_2,\cdots,B_n$ 中必有且只有发生。

例如，设试验 E 为“投掷一颗骰子观察其点数”。它的样本空间为 $S=\{1,2,3,4,5,6\}$。E 的一组事件 $B_1=\{1,2,3\}$，$B_2=\{4,5\}$，$B_3=\{6\}$ 是 S 的一组划分。而事件组 $C_1=\{1,2,3\}$, $C_2=\{3,4\}$, $C_3=\{5,6\}$ 不是 S 的划分。

**定理 1** 设试验 E 的样本空间为 S，A 为 E 的事件，$B_1,B_2,...,B_n$ 为 S 的一个划分，且 $P(B_i)>0$ $(i=1,2,...,n)$，则

$$
P(A)=P(A|B_1)P(B_1)+P(A|B_2)P(B_2)+\cdots+P(A|B_n)P(B_n) \tag{6}
$$

称为**全概率公式**。

**证明：** 因为

$$
A=AS=A(B_1\cup B_2\cup \cdots \cup B_n)=AB_1\cup AB_2\cup \cdots AB_n
$$

根据假设 $P(B_i)>0$, 且 $(AB_i)(AB_j)=\emptyset$，$I\ne j$ 得到：

$$
\begin{aligned}
P(A)&=P(AB_1)+P(AB_2)+\cdots+P(AB_n)\\
&=P(A|B_1)P(B_1)+P(A|B_2)P(B_2)+\cdots +P(A|B_n)P(B_n)
\end{aligned}
$$

**定理 2** 设试验 E 的样本空间为 S。A 为 E 的事件，$B_1,B_2,...,B_n$ 为 S 的一个划分，且 $P(A)>0$, $P(B_i)>0$ $(i=1,2,...,n)$，则：

$$
P(B_i|A)=\frac{P(A|B_i)P(B_i)}{\sum_{j=1}^n P(A|B_j)P(B_j)} \tag{7}
$$

称为**贝叶斯**（Bayes）公式。

当 $n=2$，并将 $B_1$ 记为 $B$，此时 $B_2$ 就是 $\overline{B}$，那么全概率公式和贝叶斯公式分别为：

$$
P(A)=P(A|B)P(B)+P(A|\overline{B})P(\overline{B}) \tag{8}
$$

$$
P(B|A)=\frac{P(AB)}{P(A)}=\frac{P(A|B)P(B)}{P(A|B)P(B)+P(A|\overline{B})P(\overline{B})} \tag{9}
$$

这两个公式最常用。

**例 5** 某电子设备制造厂所用的元件是由三家元件制造厂提供。根据以往的记录有以下数据：

|元件制造厂|次品率|提供元件的份额|
|---|---|---|
|1|0.02|0.15|
|2|0.01|0.80|
|3|0.03|0.05|

设这三家工厂的产品在仓库中是均匀混合的，且无区别的标志。
1. 在仓库随机取一只元件，求它是次品的概率。
2. 在仓库随机取一只元件，若已知取到的是次品，求出此次品由三家工厂生产的概率分别是多少。

**解：** 设 A 表示 “取到的是一只次品”，$B_i (i=1,2,3)$ 表示 “所取到的产品是由第 i 家工厂提供的”。显然，$B_1, B_2,B_3$ 是样本空间的一个划分，且有：

$$
P(B_1)=0.15, \quad P(B_2)=0.80,\quad P(B_3)=0.05
$$

$$
P(A|B_1)=0.02,\quad P(A|B_2)=0.01,\quad P(A|B_3)=0.03
$$

根据全概率公式：

$$
P(A)=P(A|B_1)P(B_1)+P(A|B_2)P(B_2)+P(A|B_3)P(B_3)=0.0125
$$

根据贝叶斯公式：

$$
P(B_1|A)=\frac{P(A|B_1)P(B_1)}{P(A)}=0.024
$$

$$
P(B_2|A)=0.64
$$

$$
P(B_3|A)=0.12
$$

以上结果表明，这只次品来自第 2 家工厂的可能性最大。

